openapi: 3.0.3

info:
  title: Vaping Stamps API
  version: "1.0"
  description: |
    Use this API to verify purchasing operatorsâ€™ approval to buy vaping duty stamps.

    This API exposes a single endpoint that allows the appointed stamp supplier
    to perform a daily approval status check against HMRC systems.

    Weekly CSV data submissions are handled separately via SDES using pre-signed URLs
    and are documented in the Service Guide. They are not implemented as API endpoints.

servers:
  - url: https://api.service.hmrc.gov.uk

paths:
  /misc/vaping/stamps/approval-status:
    get:
      summary: Check purchasing operator approval status
      description: |
        Checks whether a purchasing operator is approved to buy vaping duty stamps.
      operationId: checkApprovalStatus

      parameters:
        - name: vdsApprovalId
          in: query
          required: true
          description: |
            Vaping Duty Stamps Approval ID issued by HMRC.
            Format: 4 letters, 7 numbers, 2 letters.
            Example format: ABCD1234567EF
          schema:
            type: string
            pattern: "^[A-Z]{4}[0-9]{7}[A-Z]{2}$"

        - name: businessName
          in: query
          required: true
          description: Registered business name of the purchasing operator
          schema:
            type: string

      responses:
        "200":
          description: Operator record found
          content:
            application/json:
              schema:
                type: object
                required:
                  - approvalStatus
                  - businessName
                  - registeredBusinessAddress
                  - contactName
                  - contactTelephone
                  - contactEmail
                  - approvalNumber
                  - stampThreshold
                properties:
                  approvalStatus:
                    type: string
                    description: Approval status of the operator
                    example: APPROVED
                  businessName:
                    type: string
                    description: Registered business name
                  registeredBusinessAddress:
                    type: string
                    description: Registered business address
                  correspondenceAddress:
                    type: string
                    description: Correspondence address if different from the registered address
                  contactName:
                    type: string
                    description: Primary contact name
                  contactTelephone:
                    type: string
                    description: Primary contact telephone number
                  contactEmail:
                    type: string
                    format: email
                    description: Primary contact email address
                  approvalNumber:
                    type: string
                    description: Stamp approval reference number
                  stampThreshold:
                    type: number
                    description: Approved stamp purchase threshold

        "202":
          description: No record found (operator not approved)
          content:
            application/json:
              schema:
                type: object
                required:
                  - approvalStatus
                properties:
                  approvalStatus:
                    type: string
                    example: NO_RECORD
                    description: No approval record exists for the supplied identifiers

        "400":
          description: Bad request

        "401":
          description: Unauthorised

        "403":
          description: Forbidden

        "404":
          description: Not found

        "409":
          description: Conflict

components:
  securitySchemes:
    oauth2:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          scopes: {}

security:
  - oauth2: []
